---
title: "Synthetic data generation for φ_c = 0 (PCR case)"
author: "Akshay Tiwari et al."
output:
  html_document:
    toc: true
    theme: cosmo
---

```{r setup, include=FALSE}
library(tidyverse)
source(here("scripts/10_generation_psi_zero_phi.R"))
source(here("scripts/11_monte_carlo_no_phi.R"))
source(here("scripts/13_time_varying_sensitivity.R"))
source(here("scripts/14_plot_time_varying_psi.R"))
```

# Data extraction and modification
```{r}
df <- read.csv(here("data/data_main.csv"))
df1 <- read.csv(here("data/data_pcr_sens_time.csv"))

# Assuming rho_c and psi_c as true values
df1 <- df1 %>% 
  mutate(rho_true = median(df$rho_c), psi_true = median(df$psi_c))
```

# Figure S2 - Simulation of time-varying ψ estimates
```{r}
results_df <- simulate_time_varying_psi(df1,
                                        n = 1e5,
                                        n_iter_mc = 1e5,
                                        synthetic_fun = synthetic_zero_phi,
                                        formalism_fun = monte_carlo_no_phi)

# plot
p_time <- plot_time_varying_psi(results_df)
p_time
```


