"0","# --- Prepare data ---"
"0","df <- read.csv(here(""data/data_main.csv""))"
"0","df1 <- read.csv(here(""data/data_pcr_sens_time.csv""))"
"0",""
"0","df1 <- df1 %>%"
"0","  mutate("
"0","    n = 1000,"
"0","    alpha = 1 - false_neg,"
"0","    alpha_l = 1 - false_neg_u,"
"0","    alpha_u = 1 - false_neg_l,"
"0","    beta = 1.00,"
"0","    beta_l = 0.96,"
"0","    beta_u = 1.00,"
"0","    rho_true = median(df$rho_c, na.rm = TRUE),"
"0","    psi_true = median(df$psi_c, na.rm = TRUE)"
"0","  )"
"0",""
"0","alpha_params <- as.data.frame(matrix(NA, nrow = nrow(df1), ncol = 2))"
"0","beta_params <- as.data.frame(matrix(NA, nrow = nrow(df1), ncol = 2))"
"0",""
"0","colnames(alpha_params) <- c(""alpha_a"", ""alpha_b"")"
"0","colnames(beta_params) <- c(""beta_a"", ""beta_b"")"
"0",""
"0","for (i in 1:nrow(df1)) {"
"0","  alpha_params[i, ] <- estimate_beta(c(df1$alpha_l[i], df1$alpha[i], df1$alpha_u[i]), sen_range = c(0.1, 100))"
"0","  beta_params[i, ] <- estimate_beta(c(df1$beta_l[i], df1$beta[i], df1$beta_u[i]), spe_range = c(0.1, 100))"
"0","}"
"0","df1 <- cbind(df1, alpha_params, beta_params)"
