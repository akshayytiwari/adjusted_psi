"0",""
"0","quant_eta <- quantile(df$eta, probs = c(0, 0.25, 0.5, 0.75, 1))"
"0","df_quant_eta <- as.data.frame(t(quant_eta))"
"0","colnames(df_quant_eta) <- c(""Min"", ""Q1"", ""Median"", ""Q3"", ""Max"")"
"0","scale_vector <- as.numeric(round(df_quant_eta[1,]))"
"0",""
"0","# Create plot"
"0","plt <- ggplot(df) +"
"0","  geom_line(aes(x = psi_c, y = psi_c), color = ""black"", linetype = ""dashed"", size = 1) +"
"0","  geom_errorbar(aes(x = psi_c, ymin = psi_l, ymax = psi_u),   "
"0","                color = ""black"", width = 0.01, size = 0.5, alpha = 0.8) +"
"0","  geom_point(aes(x = psi_c, y = psi, fill = eta), "
"0","             shape = 21, color = ""black"", size = s_point+1) +"
"0","  # Annotate country labels using geom_text_repel()"
"0","  geom_text_repel(data = df, aes(x = psi_c, y = psi, label = country, "
"0","                                  colour = eta), angle = 90, max.overlaps = Inf,"
"0","                  size = 6, nudge_y = 0.01) +"
"0","  scale_x_continuous(breaks = seq(0, 1, by = 0.25), limits = c(0, 1.02), "
"0","                     expand = c(0, 0)) +"
"0","  scale_y_continuous(breaks = seq(0, 1, by = 0.25), limits = c(0, 1.03), "
"0","                     expand = c(0, 0)) +"
"0","  scale_fill_gradientn(colours = c(""darkviolet"", ""darkblue"", ""dodgerblue"", "
"0","                                   ""darkgreen"", ""gold"", ""chocolate"", ""firebrick3""),"
"0","                       values = scales::rescale(quant_eta)) +  "
"0","  # The breaks come from the quantiles of eta"
"0","  "
"0","  scale_colour_gradientn(colours = c(""darkviolet"", ""darkblue"", ""dodgerblue"", "
"0","                                     ""darkgreen"", ""gold"", ""chocolate"", ""firebrick3""),"
"0","                         values = scales::rescale(quant_eta)) + "
"0","  labs(x = expression(italic(psi[c])), y = expression(italic(psi))) +"
"0","  theme_minimal() +"
"0","  theme(text = element_text(family = ""Helvetica""),"
"0","    axis.text = element_text(size = s_text+2, colour = ""black""),"
"0","    axis.title = element_blank(),"
"0","        axis.ticks = element_line(linewidth = width_tick, colour = ""black""),"
"0","        axis.ticks.length = unit(length_tick, ""cm""),"
"0","        panel.border = element_rect(colour = ""black"", fill = NA, "
"0","                                    size = width_border))"
"0",""
"0","plt"
"0",""
